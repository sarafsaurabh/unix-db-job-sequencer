<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"> </head><body><h2><a name="1._Introduction">1. Introduction</a></h2><ul><li><a name="1._Introduction">unix-db-job-sequencer
is a lightweight script used to sequence (schedule) dependent Unix
shell scripts (Jobs) especially useful for running long lasting ETL and
Data Warehousing jobs. </a></li></ul><ul><li><a name="1._Introduction">This script uses tables viz. <tt>job</tt>, <tt>job_dep</tt> and <tt>job_log</tt> created in RDBMS (currently supports only Teradata RDBMS using native BTEQ CLI). </a></li></ul><ul><li><a name="1._Introduction">This script uses user defined <tt>job</tt> ids and shell script names in <tt>job</tt> table and job dependencies in <tt>job_dep</tt> table to execute dependent jobs in Unix shell. </a></li></ul><ul><li><a name="1._Introduction">Jobs mentioned in job table are executed based on their dependencies defined in <tt>job_dep</tt> table and log entries are placed in <tt>job_log</tt> table.  </a></li></ul><h2><a name="2._Job_Tables_Architecture">2. Job Tables Architecture</a></h2><h3><a name="2.1_job_Table">2.1 job Table</a></h3><ul><li><a name="2.1_job_Table"><tt>job</tt>
table consists of a unique user defined job id which identifies a
particular Unix Script to be considered for sequencing and job name
which specifies the name of the script file. </a></li></ul><ul><li><a name="2.1_job_Table"><tt>job</tt>
table can consist of duplicate (non-unique) job names. (This
functionality is provided to allow same Unix script (job) to be
executed more than once in a single sequence.) </a></li></ul><ul><li><a name="2.1_job_Table">The possible stages in which a job can exist are: </a></li></ul><p><a name="2.1_job_Table"><img src="readme_files/Unix%2520JCL_html_m1e582c53.png"> </a></p><h3><a name="2.2_job_dep_Table">2.2 job_dep Table</a></h3><ul><li><a name="2.2_job_dep_Table"><tt>job_dep</tt> table consists of job ids and their dependence on other jobs identified in <tt>job_dep_on</tt> column. </a></li></ul><ul><li><a name="2.2_job_dep_Table">A dependant job is executed only if all of its predecessors are successfully executed without any errors. </a></li></ul><ul><li><a name="2.2_job_dep_Table">A null in <tt>job_dep_on</tt> column signifies that the job is ready to be executed and is independent of any other jobs defined in <tt>job</tt> table. </a></li></ul><ul><li><a name="2.2_job_dep_Table"><font color="red">NOTE: The sequencer will only start if all the jobs defined in <tt>job</tt> table are present in <tt>job_dep</tt> table. Independent jobs are added in <tt>job_dep</tt> table by providing nulls in <tt>job_dep_on</tt> column</font> </a></li></ul><p><a name="2.2_job_dep_Table"><img src="readme_files/Unix%2520JCL_html_6cf7204b.png"> </a></p><h3><a name="2.3_job_log_table">2.3 job_log table</a></h3><ul><li><a name="2.3_job_log_table"><tt>job_log</tt> table consists status of currently executing jobs as well as history. </a></li></ul><ul><li><a name="2.3_job_log_table">This
table includes information pertaining to every single execution of a
job in the sequencer. Apart form the job name and job id, it provides
start and end time for a job. </a></li></ul><ul><li><a name="2.3_job_log_table">The possible stages in which a job can exist are: </a></li><ol><li><a name="2.3_job_log_table"><strong>Success:</strong> Job is successfully executed without any errors. </a></li><li><a name="2.3_job_log_table"><strong>Waiting:</strong> Sequencer has withheld this job from execution until all its predecessors are successfully executed. </a></li><li><a name="2.3_job_log_table"><strong>Running:</strong> Job is currently executing. </a></li><li><a name="2.3_job_log_table"><strong>Failed:</strong>
Job has finished with errors. The status mentions the number of errors
and the error file in which all the errors encountered during execution
are logged. </a></li><li><a name="2.3_job_log_table"><strong>Interrupted:</strong> The job is interrupted either by the user or it has been abandoned due to session disconnection. </a></li><li><a name="2.3_job_log_table"><strong>Not started:</strong> Job cannot be executed due to its predecessor failing, being interrupted or not started. </a></li></ol></ul><p><a name="2.3_job_log_table"><img src="readme_files/Unix%2520JCL_html_m4e22f2f6.png"> </a></p><h2><a name="3._Error_Handling">3. Error Handling</a></h2><h3><a name="3.1_Job_Failure_Handling">3.1 Job Failure Handling</a></h3><ul><li><a name="3.1_Job_Failure_Handling">If
any errors are encountered during job execution, the status of the job
is updated as â&#8364;&#339;Failedâ&#8364;&#157; along with the number of errors. Any
dependant jobs are updated into â&#8364;&#339;Not Started due to parent job
failureâ&#8364;&#157; state. </a></li></ul><p><a name="3.1_Job_Failure_Handling"><img src="readme_files/Unix%2520JCL_html_m1a37e8cf.png"> </a></p><h3><a name="3.2_Job_Interruption_Handling">3.2 Job Interruption Handling</a></h3><ul><li><a name="3.2_Job_Interruption_Handling">The
sequencer stops its execution on encountering following signals and
updates the status of currently executing jobs as â&#8364;&#339;Interruptedâ&#8364;&#157; and
its dependent jobs as â&#8364;&#339;Not started due to parent job Interruptionâ&#8364;&#157;:
</a></li><ol><li><a name="3.2_Job_Interruption_Handling"><strong>SIGHUP:</strong> Hangup </a></li><li><a name="3.2_Job_Interruption_Handling"><strong>SIGINT:</strong> Interrupt </a></li><li><a name="3.2_Job_Interruption_Handling"><strong>SIGQUIT:</strong> Quit </a></li><li><a name="3.2_Job_Interruption_Handling"><strong>SIGTERM:</strong> Terminated </a></li></ol></ul><p><a name="3.2_Job_Interruption_Handling"><img src="readme_files/Unix%2520JCL_html_2e78591b.png"> </a></p><h3><a name="3.3_Other_Initial_error_handlers">3.3 Other Initial error handlers</a></h3><ul><li><a name="3.3_Other_Initial_error_handlers">There are few other error handlers incorporated in the script: </a></li><ol><li><a name="3.3_Other_Initial_error_handlers">Checking existence of job tables </a></li><li><a name="3.3_Other_Initial_error_handlers">Checking proper job entries in <tt>job_dep</tt> table </a></li><li><a name="3.3_Other_Initial_error_handlers">Checking existence of job files in the same folder </a></li><li><a name="3.3_Other_Initial_error_handlers">Checking
existence of a global deadlock of dependent jobs(This scenario will
occur when there are no initially ready jobs. i.e.aAbsence of a null in
<tt>job_dep_on</tt> column in <tt>job_dep</tt> table) </a></li></ol></ul><ul><li><a name="3.3_Other_Initial_error_handlers">For any of the above mentioned errors the sequencer will not start and will specify an error message on the prompt. </a></li></ul><h2><a name="4._Script_Execution">4. Script Execution</a></h2><ul><li><a name="4._Script_Execution">The required database tables can be created by executing tables.sql script in Teradata bteq. </a></li></ul><ul><li><a name="4._Script_Execution">There are in all three files "jcl.ksh", "bteq.ksh" and database information file "env.dat" </a></li></ul><ul><li><a name="4._Script_Execution">Information for database viz. server name, database name, username and password is entered in env.dat file. </a></li></ul><ul><li><a name="4._Script_Execution">These scripts are placed in a single folder along with the Unix scripts (Jobs) to be executed. </a></li></ul><ul><li><a name="4._Script_Execution"><font color="red">NOTE:
The main sequencer scripts and Job scripts need to placed in the same
folder or else the PATH of the folder containing the job scripts is
required to be entered manually in ".profile" file.</font> </a></li></ul><ul><li><a name="4._Script_Execution">The
sequencer is started by executing the "jcl.ksh" script directly
(execute access required) or by prefixing it with the shell name. </a></li></ul>

<div id="_ilx_updateIcon_"></div><div id="_alertShown_"></div></body></html>